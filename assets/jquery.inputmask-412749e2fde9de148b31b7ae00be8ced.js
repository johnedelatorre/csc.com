/**
* @license Input Mask plugin for jquery
* http://github.com/RobinHerbots/jquery.inputmask
* Copyright (c) 2010 - 2012 Robin Herbots
* Licensed under the MIT license (http://www.opensource.org/licenses/mit-license.php)
* Version: 1.2.2
*/
!function(t){void 0==t.fn.inputmask&&(t.inputmask={defaults:{placeholder:"_",optionalmarker:{start:"[",end:"]"},escapeChar:"\\",mask:null,oncomplete:t.noop,onincomplete:t.noop,oncleared:t.noop,repeat:0,greedy:!0,autoUnmask:!1,clearMaskOnLostFocus:!0,insertMode:!0,clearIncomplete:!1,aliases:{},onKeyUp:t.noop,onKeyDown:t.noop,showMaskOnHover:!0,numericInput:!1,radixPoint:".",definitions:{9:{validator:"[0-9]",cardinality:1},a:{validator:"[A-Za-zА-яЁё]",cardinality:1},"*":{validator:"[A-Za-zА-яЁё0-9]",cardinality:1}},keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91},ignorables:[8,9,13,16,17,18,20,27,33,34,35,36,37,38,39,40,46,91,93,108]},val:t.fn.val},t.fn.inputmask=function(e,i){function s(t){var e=document.createElement("input"),t="on"+t,i=t in e;return i||(e.setAttribute(t,"return;"),i="function"==typeof e[t]),e=null,i}function n(e){var s=k.aliases[e];return s?(s.alias&&n(s.alias),t.extend(!0,k,s),t.extend(!0,k,i),!0):!1}function o(){var e=!1,i=0;1==k.mask.length&&0==k.greedy&&(k.placeholder="");for(var s=t.map(k.mask.split(""),function(t){var s=[];if(t==k.escapeChar)e=!0;else if(t!=k.optionalmarker.start&&t!=k.optionalmarker.end||e){var n=k.definitions[t];if(n&&!e)for(var o=0;o<n.cardinality;o++)s.push(d(i+o));else s.push(t),e=!1;return i+=s.length,s}}),n=s.slice(),o=1;o<k.repeat&&k.greedy;o++)n=n.concat(s.slice());return n}function r(){var e=!1,i=!1,s=!1;return t.map(k.mask.split(""),function(t){var n=[];if(t==k.escapeChar)i=!0;else if(t!=k.optionalmarker.start||i){if(t!=k.optionalmarker.end||i){var o=k.definitions[t];if(o&&!i){for(var r=o.prevalidator,a=r?r.length:0,l=1;l<o.cardinality;l++){var h=a>=l?r[l-1]:[],d=h.validator,c=h.cardinality;n.push({fn:d?"string"==typeof d?new RegExp(d):new function(){this.test=d}:new RegExp("."),cardinality:c?c:1,optionality:e,newBlockMarker:1==e?s:!1,offset:0,casing:o.casing,def:t}),1==e&&(s=!1)}n.push({fn:o.validator?"string"==typeof o.validator?new RegExp(o.validator):new function(){this.test=o.validator}:new RegExp("."),cardinality:o.cardinality,optionality:e,newBlockMarker:s,offset:0,casing:o.casing,def:t})}else n.push({fn:null,cardinality:0,optionality:e,newBlockMarker:s,offset:0,casing:null,def:t}),i=!1;return s=!1,n}e=!1,s=!0}else e=!0,s=!0})}function a(t,e,i,s){if(0>t||t>=c())return!1;for(var n=h(t),o=e?1:0,r="",a=_[n].cardinality;a>o;a--)r+=m(i,n-(a-1));return e&&(r+=e),null!=_[n].fn?_[n].fn.test(r,i,t,s,k):!1}function l(t){var e=h(t),i=_[e];return void 0!=i?i.fn:!1}function h(t){return t%_.length}function d(t){return k.placeholder.charAt(t%k.placeholder.length)}function c(){var t=R.length;return!k.greedy&&k.repeat>1&&(t+=R.length*(k.repeat-1)),t}function u(t,e){var i=c();if(e>=i)return i;for(var s=e;++s<i&&!l(s););return s}function f(t,e){var i=e;if(0>=i)return 0;for(;--i>0&&!l(i););return i}function p(t,e,i){var s=_[h(e)],n=i;if(void 0!=n)switch(s.casing){case"upper":n=i.toUpperCase();break;case"lower":n=i.toLowerCase()}t[e]=n}function m(t,e,i){return i&&(e=g(t,e)),t[e]}function g(t,e,i){var s;if(i)for(;0>e&&t.length<c();)for(s=R.length-1,e=R.length;void 0!==R[s];)t.unshift(R[s--]);else for(;void 0==t[e]&&t.length<c();)for(s=0;void 0!==R[s];)t.push(R[s++]);return e}function x(t,e,i){t._valueSet(e.join("")),void 0!=i&&(A?setTimeout(function(){S(t,i)},100):S(t,i))}function v(t,e,i){for(var s=e,n=c();i>s&&n>s;s++)p(t,s,m(R.slice(),s))}function E(t,e){var i=h(e);p(t,e,m(R,i))}function y(e,i,s,n){var o=t(e).data("inputmask").isRTL,r=w(e._valueGet(),o).split("");if(o){var f=c(),g=r.reverse();g.length=f;for(var y=0;f>y;y++){var b=h(f-(y+1));null==_[b].fn&&g[y]!=m(R,b)?(g.splice(y,0,m(R,b)),g.length=f):g[y]=g[y]||m(R,b)}r=g.reverse()}v(i,0,i.length),i.length=R.length;for(var C,T=-1,S=-1,f=c(),D=r.length,M=0==D?f:-1,y=0;D>y;y++)for(var I=S+1;f>I;I++){if(l(I)){var A=r[y];(C=a(I,A,i,!s))!==!1?(C!==!0&&(I=C.pos||I,A=C.c||A),p(i,I,A),T=S=I):(E(i,I),A==d(I)&&(S=I,M=I));break}if(E(i,I),T==S&&(T=I),S=I,r[y]==m(i,I))break}if(0==k.greedy)for(var F=w(i.join(""),o).split("");i.length!=F.length;)o?i.shift():i.pop();return s&&x(e,i),o?k.numericInput?-1!=t.inArray(k.radixPoint,i)&&n!==!0?t.inArray(k.radixPoint,i):u(i,f):u(i,M):u(i,T)}function b(t){var e=["/",".","*","+","?","|","(",")","[","]","{","}","\\"];return t.replace(new RegExp("(\\"+e.join("|\\")+")","gim"),"\\$1")}function w(t,e){return e?t.replace(new RegExp("^("+b(R.join(""))+")*"),""):t.replace(new RegExp("("+b(R.join(""))+")*$"),"")}function C(e,i){y(e,i,!1);var s=i.slice();if(t(e).data("inputmask").isRTL)for(var n=0;n<=s.length-1;n++){var o=h(n);if(!_[o].optionality)break;if(d(n)!=i[n]&&l(n))break;s.splice(0,1)}else for(var n=s.length-1;n>=0;n--){var o=h(n);if(!_[o].optionality)break;if(d(n)!=i[n]&&l(n))break;s.pop()}x(e,s)}function T(e,i){var s=e[0];if(!_||i!==!0&&e.hasClass("hasDatepicker"))return s._valueGet();var n=R.slice();return y(s,n),t.map(n,function(t,e){return l(e)&&t!=m(R.slice(),e)?t:null}).join("")}function S(t,e,i){var s=t.jquery&&t.length>0?t[0]:t;if("number"!=typeof e){var n=A?o:null,o=null;if(null==n){if(s.setSelectionRange)e=s.selectionStart,i=s.selectionEnd;else if(document.selection&&document.selection.createRange){var r=document.selection.createRange();e=0-r.duplicate().moveStart("character",-1e5),i=e+r.text.length}n={begin:e,end:i}}return n}if(i="number"==typeof i?i:e,0==k.insertMode&&e==i&&i++,s.setSelectionRange)s.setSelectionRange(e,i);else if(s.createTextRange){var r=s.createTextRange();r.collapse(!0),r.moveEnd("character",i),r.moveStart("character",e),r.select()}s.focus(),A&&i!=s.selectionEnd&&(o={begin:e,end:i})}function D(e){function i(t){for(var e=!0,i=t._valueGet(),s=i.length,n=0;s>n;n++)if(l(n)&&i.charAt(n)==d(n)){e=!1;break}return e}function s(e){var i=t._data(e).events;t.each(i,function(i,s){t(e).bind(i+".inputmask",function(t){return this.readOnly||this.disabled?(t.stopPropagation(),t.stopImmediatePropagation(),t.preventDefault(),!1):void 0});for(var n=s[s.length-1],o=s.length-1;o>0;o--)s[o]=s[o-1];s[0]=n})}function n(e){var i;Object.getOwnPropertyDescriptor&&(i=Object.getOwnPropertyDescriptor(e,"value")),i&&i.get?e._valueGet||(e._valueGet=i.get,e._valueSet=i.set,Object.defineProperty(e,"value",{get:function(){var e=t(this),i=t(this).data("inputmask");return i&&i.autoUnmask?e.inputmask("unmaskedvalue"):this._valueGet()!=i._buffer.join("")?this._valueGet():""},set:function(e){this._valueSet(e),t(this).triggerHandler("setvalue.inputmask")}})):document.__lookupGetter__&&e.__lookupGetter__("value")?e._valueGet||(e._valueGet=e.__lookupGetter__("value"),e._valueSet=e.__lookupSetter__("value"),e.__defineGetter__("value",function(){var e=t(this),i=t(this).data("inputmask");return i&&i.autoUnmask?e.inputmask("unmaskedvalue"):this._valueGet()!=i._buffer.join("")?this._valueGet():""}),e.__defineSetter__("value",function(e){this._valueSet(e),t(this).triggerHandler("setvalue.inputmask")})):(e._valueGet||(e._valueGet=function(){return this.value},e._valueSet=function(t){this.value=t}),1!=t.fn.val.inputmaskpatch&&(t.fn.val=function(){if(0==arguments.length){var e=t(this);if(e.data("inputmask")){if(e.data("inputmask").autoUnmask)return e.inputmask("unmaskedvalue");var i=t.inputmask.val.apply(e);return i!=e.data("inputmask")._buffer.join("")?i:""}return t.inputmask.val.apply(e)}var s=arguments;return this.each(function(){var e=t(this),i=t.inputmask.val.apply(e,s);return e.data("inputmask")&&e.triggerHandler("setvalue.inputmask"),i})},t.extend(t.fn.val,{inputmaskpatch:!0})))}function o(t,e,i){for(;!l(t)&&t-1>=0;)t--;for(var s=t;e>s&&s<c();s++)if(l(s)){E(P,s);var n=u(P,s),o=m(P,n);if(o!=d(n)){if(n<c()&&a(s,o,P,!0)!==!1&&_[h(s)].def==_[h(n)].def)p(P,s,m(P,n)),E(P,n);else if(l(s))break}else if(void 0==i)break}else E(P,s);return void 0!=i&&p(P,V?e:f(P,e),i),P=w(P.join(""),V).split(""),0==P.length&&(P=R.slice()),t}function r(t,e,i,s){for(var n=t;e>=n&&n<c();n++)if(l(n)){var o=m(P,n);if(p(P,n,i),o!=d(n)){var r=u(P,n);if(!(r<c()))break;if(a(r,o,P,!0)!==!1&&_[h(n)].def==_[h(r)].def)i=o;else{if(l(r))break;i=o}}else if(s!==!0)break}else E(P,n);var f=P.length;return P=w(P.join(""),V).split(""),0==P.length&&(P=R.slice()),e-(f-P.length)}function b(e){O=!1;var i=this,s=e.keyCode,n=S(i);if(k.numericInput){var a=i._valueGet(),l=a.indexOf(k.radixPoint);-1!=l&&(V=n.begin<=l||n.end<=l)}if(s==k.keyCode.BACKSPACE||s==k.keyCode.DELETE||I&&127==s){var h=c();if(0==n.begin&&n.end==h)P=R.slice(),x(i,P),S(i,y(i,P,!1));else if(n.end-n.begin>1||1==n.end-n.begin&&k.insertMode)v(P,n.begin,n.end),x(i,P,V?y(i,P,!1):n.begin);else{var f=n.begin-(s==k.keyCode.DELETE?0:1);H>f&&s==k.keyCode.DELETE&&(f=H),f>=H&&(k.numericInput&&k.greedy&&s==k.keyCode.DELETE&&P[f]==k.radixPoint&&(f=u(P,f),V=!1),V?(f=r(H,f,d(f),!0),f=k.numericInput&&k.greedy&&s==k.keyCode.BACKSPACE&&P[f+1]==k.radixPoint?f+1:u(P,f)):f=o(f,h),x(i,P,f))}return i._valueGet()==R.join("")&&t(i).trigger("cleared"),!1}if(s==k.keyCode.END||s==k.keyCode.PAGE_DOWN)return setTimeout(function(){var t=y(i,P,!1,!0);k.insertMode||t!=c()||e.shiftKey||t--,S(i,e.shiftKey?n.begin:t,t)},0),!1;if(s==k.keyCode.HOME||s==k.keyCode.PAGE_UP)return S(i,0,e.shiftKey?n.begin:0),!1;if(s==k.keyCode.ESCAPE)return i._valueSet(L),S(i,0,y(i,P)),!1;if(s==k.keyCode.INSERT)return k.insertMode=!k.insertMode,S(i,k.insertMode||n.begin!=c()?n.begin:n.begin-1),!1;if(e.ctrlKey&&88==s)setTimeout(function(){S(i,y(i,P,!0))},0);else if(!k.insertMode){if(s==k.keyCode.RIGHT){var p=n.begin==n.end?n.end+1:n.end;return p=p<c()?p:n.end,S(i,e.shiftKey?n.begin:p,e.shiftKey?p+1:p),!1}if(s==k.keyCode.LEFT){var p=n.begin-1;return p=p>0?p:0,S(i,p,e.shiftKey?n.end:p),!1}}k.onKeyDown.call(this,e,k),B=-1!=t.inArray(s,k.ignorables)}function T(e){if(O)return!1;O=!0;var s=this,n=t(s);e=e||window.event;var l=e.which||e.charCode||e.keyCode;if(k.numericInput&&l==k.radixPoint.charCodeAt(k.radixPoint.length-1)){var h=s._valueGet(),E=h.indexOf(k.radixPoint);S(s,u(P,-1!=E?E:c()))}if(e.ctrlKey||e.altKey||e.metaKey||B)return!0;if(l){n.trigger("input");var y=S(s),b=String.fromCharCode(l),w=c();if(v(P,y.begin,y.end),V){var C,T=k.numericInput?y.end:f(P,y.end);if((C=a(T==w||m(P,T)==k.radixPoint?f(P,T):T,b,P,!1))!==!1){C!==!0&&(T=C.pos||y,b=C.c||b);var D=H;if(1==k.insertMode){if(1==k.greedy)for(var M=P.slice();m(M,D,!0)!=d(D)&&T>=D;)D=D==w?w+1:u(P,D);if(!(T>=D&&(k.greedy||P.length<w)))return!1;if(P[H]!=d(H)&&P.length<w){var I=g(P,-1,V);0!=y.end&&(T+=I),w=P.length}o(D,k.numericInput?f(P,T):T,b)}else p(P,k.numericInput?f(P,T):T,b);x(s,P,k.numericInput&&0==T?u(P,T):T),setTimeout(function(){i(s)&&n.trigger("complete")},0)}else A&&x(s,P,y.begin)}else{var C,T=u(P,y.begin-1);if(g(P,T,V),(C=a(T,b,P,!1))!==!1){if(C!==!0&&(T=C.pos||T,b=C.c||b),1==k.insertMode){for(var F=c(),M=P.slice();m(M,F,!0)!=d(F)&&F>=T;)F=0==F?-1:f(P,F);if(!(F>=T))return!1;r(T,P.length,b)}else p(P,T,b);var N=u(P,T);x(s,P,N),setTimeout(function(){i(s)&&n.trigger("complete")},0)}else A&&x(s,P,y.begin)}return!1}}function D(e){var i=t(this),s=this,n=e.keyCode;k.onKeyUp.call(this,e,k),n==k.keyCode.TAB&&i.hasClass("focus.inputmask")&&0==s._valueGet().length&&(P=R.slice(),x(s,P),V||S(s,0),L=s._valueGet())}var F=t(e);if(F.is(":input")){k.greedy=k.greedy?k.greedy:0==k.repeat;var N=F.prop("maxLength");c()>N&&N>-1&&(N<R.length&&(R.length=N),0==k.greedy&&(k.repeat=Math.round(N/R.length))),F.prop("maxLength",2*c()),F.data("inputmask",{tests:_,_buffer:R,greedy:k.greedy,repeat:k.repeat,autoUnmask:k.autoUnmask,definitions:k.definitions,isRTL:!1}),n(e);var P=R.slice(),L=e._valueGet(),O=!1,B=!1,z=-1,H=u(P,-1),V=(f(P,c()),!1);if("rtl"==e.dir||k.numericInput){e.dir="ltr",F.css("text-align","right"),F.removeAttr("dir");var j=F.data("inputmask");j.isRTL=!0,F.data("inputmask",j),V=!0}F.unbind(".inputmask"),F.removeClass("focus.inputmask"),F.bind("mouseenter.inputmask",function(){var e=t(this),i=this;if(!e.hasClass("focus.inputmask")&&k.showMaskOnHover){var s=i._valueGet().length;s<P.length&&(0==s&&(P=R.slice()),x(i,P))}}).bind("blur.inputmask",function(){var e=t(this),s=this,n=s._valueGet();e.removeClass("focus.inputmask"),n!=L&&e.change(),k.clearMaskOnLostFocus&&(n==R.join("")?s._valueSet(""):C(s,P)),i(s)||(e.trigger("incomplete"),k.clearIncomplete&&(k.clearMaskOnLostFocus?s._valueSet(""):(P=R.slice(),x(s,P))))}).bind("focus.inputmask",function(){var e=t(this),i=this;if(!e.hasClass("focus.inputmask")&&!k.showMaskOnHover){var s=i._valueGet().length;s<P.length&&(0==s&&(P=R.slice()),S(i,y(i,P,!0)))}e.addClass("focus.inputmask"),L=i._valueGet()}).bind("mouseleave.inputmask",function(){var e=t(this),i=this;k.clearMaskOnLostFocus&&(e.hasClass("focus.inputmask")||(i._valueGet()==R.join("")||""==i._valueGet()?i._valueSet(""):C(i,P)))}).bind("click.inputmask",function(){var t=this;setTimeout(function(){var e=S(t);if(e.begin==e.end){var i=e.begin;z=y(t,P,!1),V?S(t,i>z&&(a(i,P[i],P,!0)!==!1||!l(i))?i:z):S(t,z>i&&(a(i,P[i],P,!0)!==!1||!l(i))?i:z)}},0)}).bind("dblclick.inputmask",function(){var t=this;setTimeout(function(){S(t,0,z)},0)}).bind("keydown.inputmask",b).bind("keypress.inputmask",T).bind("keyup.inputmask",D).bind(M+".inputmask, dragdrop.inputmask, drop.inputmask",function(){var t=this;setTimeout(function(){S(t,y(t,P,!0))},0)}).bind("setvalue.inputmask",function(){var t=this;L=t._valueGet(),y(t,P,!0),t._valueGet()==R.join("")&&t._valueSet("")}).bind("complete.inputmask",k.oncomplete).bind("incomplete.inputmask",k.onincomplete).bind("cleared.inputmask",k.oncleared),z=y(e,P,!0);var W;try{W=document.activeElement}catch(U){}W===e?(F.addClass("focus.inputmask"),S(e,z)):k.clearMaskOnLostFocus&&(e._valueGet()==R.join("")?e._valueSet(""):C(e,P)),s(e)}}var k=t.extend(!0,{},t.inputmask.defaults,i),M=s("paste")?"paste":"input",I=null!=navigator.userAgent.match(/iphone/i),A=null!=navigator.userAgent.match(/android.*mobile safari.*/i);if(A){var F=navigator.userAgent.match(/mobile safari.*/i),N=parseInt(new RegExp(/[0-9]+/).exec(F));A=533>=N}if("string"==typeof e)switch(e){case"mask":var R=o(),_=r();return this.each(function(){D(this)});case"unmaskedvalue":var _=this.data("inputmask").tests,R=this.data("inputmask")._buffer;return k.greedy=this.data("inputmask").greedy,k.repeat=this.data("inputmask").repeat,k.definitions=this.data("inputmask").definitions,T(this);case"remove":var _,R;return this.each(function(){var e=t(this),i=this;setTimeout(function(){if(e.data("inputmask")){_=e.data("inputmask").tests,R=e.data("inputmask")._buffer,k.greedy=e.data("inputmask").greedy,k.repeat=e.data("inputmask").repeat,k.definitions=e.data("inputmask").definitions,i._valueSet(T(e,!0)),e.removeData("inputmask"),e.unbind(".inputmask"),e.removeClass("focus.inputmask");var t;Object.getOwnPropertyDescriptor&&(t=Object.getOwnPropertyDescriptor(i,"value")),t&&t.get?i._valueGet&&Object.defineProperty(i,"value",{get:i._valueGet,set:i._valueSet}):document.__lookupGetter__&&i.__lookupGetter__("value")&&i._valueGet&&(i.__defineGetter__("value",i._valueGet),i.__defineSetter__("value",i._valueSet)),delete i._valueGet,delete i._valueSet}},0)});case"getemptymask":return this.data("inputmask")?this.data("inputmask")._buffer.join(""):"";case"hasMaskedValue":return this.data("inputmask")?!this.data("inputmask").autoUnmask:!1;default:n(e)||(k.mask=e);var R=o(),_=r();return this.each(function(){D(this)})}if("object"==typeof e){k=t.extend(!0,{},t.inputmask.defaults,e),n(k.alias);var R=o(),_=r();return this.each(function(){D(this)})}})}(jQuery);